# SM4 算法简介

## 📌 什么是 SM4？

SM4 是由中国国家密码管理局制定的对称分组加密算法，原名为 **SMS4**，最初用于中国无线局域网标准 **WAPI** 中的数据加密。2012 年被正式列为国家密码标准（GB/T 32907-2016）。

- **算法类型**：对称分组密码
- **分组长度**：128 位
- **密钥长度**：128 位
- **轮数**：32 轮

---

## 🔐 加密流程概述

SM4 是一种 Feistel 结构的加密算法，其处理流程如下：

1. **输入**：
   - 明文：128 位（16 字节）
   - 密钥：128 位（16 字节）

2. **轮密钥扩展（Key Expansion）**：
   - 从主密钥生成 32 个轮密钥

3. **轮函数（Round Function）**：
   每一轮包括以下操作：
   - 轮密钥加
   - 非线性变换（使用 S-box）
   - 线性变换（移位 + 异或）

4. **32 轮迭代处理**
   - 输入的四个 32 位字（X0, X1, X2, X3）按照公式进行迭代更新：
     ```
     X[i+4] = X[i] ⊕ F(X[i+1], X[i+2], X[i+3], rk[i])
     ```

5. **输出反序排列（Reverse）**
   - 输出为：`X[35], X[34], X[33], X[32]`

---

## 🧮 关键组件

### ✅ S盒（S-box）
非线性变换部分，使用一个固定的 8-bit 输入 → 8-bit 输出的置换表，增强算法的抗差分攻击能力。

### ✅ 线性变换
使用轮函数 F 中的线性变换增强明文与密钥的扩散性：
```text
L(B) = B ⊕ (B <<< 2) ⊕ (B <<< 10) ⊕ (B <<< 18) ⊕ (B <<< 24)

